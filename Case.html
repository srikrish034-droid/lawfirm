<!DOCTYPE html>
<html>
<head>
<title>Case Management</title>
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;500;600&display=swap" rel="stylesheet">
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
<script src="script.js"></script>

<style>
*{margin:0;padding:0;box-sizing:border-box;font-family:'Poppins',sans-serif;}
body{display:flex;background:#0f172a;color:white;}

.sidebar{
width:240px;
background:#111827;
height:100vh;
padding:30px 20px;
position:fixed;
}
.sidebar h2{text-align:center;margin-bottom:40px;}
.sidebar a{
display:block;
color:#cbd5e1;
text-decoration:none;
margin:15px 0;
padding:10px;
border-radius:8px;
}
.sidebar a:hover{background:#2563eb;color:white;}

.main{
margin-left:240px;
padding:40px;
width:100%;
}

.card{
background:#1e293b;
padding:20px;
border-radius:12px;
margin-bottom:20px;
}

input{
padding:10px;
margin:6px;
border:none;
border-radius:6px;
width:220px;
}

button{
padding:8px 14px;
border:none;
border-radius:6px;
cursor:pointer;
margin:4px;
}

.save{background:#2563eb;color:white;}
.update{background:#10b981;color:white;}
.delete{background:#ef4444;color:white;}

table{
width:100%;
border-collapse:collapse;
background:#1e293b;
border-radius:10px;
overflow:hidden;
}

th,td{
padding:12px;
text-align:left;
}

th{background:#2563eb;}
tr:hover{background:#334155;}
</style>
</head>
<body>

<div class="sidebar">
<h2>âš– LawFirm</h2>

<a href="Dashboard.html">Dashboard</a>
<a href="Client.html">Clients</a>
<a href="Case.html">Cases</a>
<a href="Invoice.html">Invoices</a>

<button onclick="logout()" 
style="
width:100%;
padding:10px;
margin-top:40px;
background:#ef4444;
color:white;
border:none;
border-radius:8px;
cursor:pointer;
font-weight:500;
">
Logout
</button>

</div>


<div class="main">

<h1>Case Management</h1>

<div class="card">
<input type="hidden" id="case_id">
<input id="client_name" placeholder="Client Name">
<input id="client_role" placeholder="Client Role">
<input id="case_reference_number" placeholder="Case Reference No">
<input id="level_of_urgency" placeholder="Urgency Level">
<input id="court_no" placeholder="Court No">
<input id="judge_name" placeholder="Judge Name">
<br>
<button class="save" onclick="saveCase()">Save</button>
<button class="update" onclick="updateCase()">Update</button>
<button onclick="resetForm()">Clear</button>
</div>

<div class="card">
<table>
<thead>
<tr>
<th>Client</th>
<th>Role</th>
<th>Reference No</th>
<th>Court</th>
<th>Judge</th>
<th>Action</th>
</tr>
</thead>
<tbody id="caseTable"></tbody>
</table>
</div>

</div>

<script>
const supabaseClient = supabase.createClient(
"https://nilimvtdacrzikjagooi.supabase.co",
"sb_publishable_ZikX8pNNMhvjzbjUwnXjNg_fpI2tT_y"
);

async function loadCases(){
let {data}=await supabaseClient.from("cases").select("*");
caseTable.innerHTML="";
data.forEach(c=>{
caseTable.innerHTML+=`
<tr>
<td>${c.client_name}</td>
<td>${c.client_role||""}</td>
<td>${c.case_reference_number}</td>
<td>${c.court_no}</td>
<td>${c.judge_name||""}</td>
<td>
<button onclick="editCase('${c.id}','${c.client_name}','${c.client_role}','${c.case_reference_number}','${c.level_of_urgency}','${c.court_no}','${c.judge_name}')">Edit</button>
<button class="delete" onclick="deleteCase('${c.id}')">Delete</button>
</td>
</tr>`;
});
}

async function saveCase(){
await supabaseClient.from("cases").insert([{
client_name:client_name.value,
client_role:client_role.value,
case_reference_number:case_reference_number.value,
level_of_urgency:level_of_urgency.value,
court_no:court_no.value,
judge_name:judge_name.value
}]);
resetForm();
loadCases();
}

function editCase(id,name,role,ref,urgency,court,judge){
case_id.value=id;
client_name.value=name;
client_role.value=role;
case_reference_number.value=ref;
level_of_urgency.value=urgency;
court_no.value=court;
judge_name.value=judge;
}

async function updateCase(){
await supabaseClient.from("cases")
.update({
client_name:client_name.value,
client_role:client_role.value,
case_reference_number:case_reference_number.value,
level_of_urgency:level_of_urgency.value,
court_no:court_no.value,
judge_name:judge_name.value
})
.eq("id",case_id.value);

resetForm();
loadCases();
}

async function deleteCase(id){
await supabaseClient.from("cases").delete().eq("id",id);
loadCases();
}

function resetForm(){
case_id.value="";
client_name.value="";
client_role.value="";
case_reference_number.value="";
level_of_urgency.value="";
court_no.value="";
judge_name.value="";
}

loadCases();
</script>

</body>
</html>
